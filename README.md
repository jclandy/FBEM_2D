# FBEM_2D
2D version of the Facet-Based SAR Altimeter Echo Model

The original 3D version of the Facet-Based SAR Altimeter Echo Model https://github.com/jclandy/FBEM simulates the radar altimeter echo as the sum of the backscatter from the air-snow interface, snow layer, and snow-ice interface, at every facet of a tetrahedral mesh representing the snow and ice topography. The main advantage of the 3D version of the model is the realism, enabling waveforms to be simulated from surface topographies acquired for example by airborne laser scanning. The main disadvantage of the 3D version is the time required to simulate each waveform, especially for many single looks of a multilooked SAR echo. This is particularly limiting when it is necessary to generate a mean echo representing the average for a specific statistical sea ice surface, e.g. one represented by the parameter set [rms height (sigma_surf), correlation length (l_surf)], which is the case when building a lookup table for applications to altimeter waveform retracking. Typically, hundreds of model iterations are required to generate a stable mean echo for each parameterized topography.

The 2D version of the model is designed to produce the exact mean echo for a statistical sea ice surface with parameter set [sigma_surf, l_surf] with only one iteration, while not reducing the realism or functionality of the full 3D version of the model.

This is done through the integration of the flat-surface impulse response with the transmitted echo and radar backscatter, as a function of the slope distribution of the surface, before convolution with the surface height distribution. The backscattering response can be generated for a single sea ice surface, or a system including the air-snow interface, snow volume, and snow-ice interface, and accounts for the impact of the large-scale snow and sea ice topography on the radar backscatter. Surface/interface backscatter distributions are calculated with the physical optics method and Updated Integral Equation Model (I2EM), but as default, approximated in the main integration by a Gaussian function that enables x10+ speedup with an error <0.01%. The exact backscatter response can be included in the waveform integral instead of the Gaussian approximation, if desired.

The 2D model also accounts for the radar electromagnetic bias, which is included directly within the 3D version of the model but is typically ignored in most analytical/semianalytical models for the SAR altimeter echo which assume Gaussian topography. In the case of surfaces with non-Gaussian height distribution, the surface height and slope can be correlated, invalidating the assumption that all portions of the surface height distribution produce identical backscatter responses. This is accounted for here by weighting the height distribution for the backscatter contribution as a function of slope, i.e. if the probability of a certain slope is more likely for a certain bin of the height distribution, the surface backscatter response is weighted for that probability. An estimate for the radar EM bias is provided as a model result and mainly depends on the large-scale distribution of surface slopes, i.e. ~sigma_surf/l_surf, and the radar-scale roughness [sigma_si, l_si] or [sigma_s, l_s].

The tradeoff between accuracy and spped of the 2D numerical integration of the FSIR, transmitted echo and backscatter response, can be tuned with the 'abstol','reltol', and 'MaxFunEvals' settings of quad2d.

The 2D model is set up to simulate single-look echoes of a SAR echo in parallel; however, for simulating pulse-limited LRM echoes, the parallel processing can be performed on one of the loops in SHELL_* instead, to improve performance.

Please get in touch if you find bugs, errors or have suggestions for improvements, jack.c.landy@uit.no. Or submit a push request.
